---
layout: page
title: Malware Indicator for File Hash
categories: examples
---

A commonly-shared form of threat intelligence as practiced today is the sharing of host-based indicators for malicious code, which are most often file names and hashes. This example describes a file hash indicator and the name and type of the piece of malware that it indicates.

**Scenario**
----------

This scenario consists of the description of a simple indicator that represents a pattern for a file with a given hash and the context that if a file with that hash is seen it might indicate a sample of Poison Ivy is present.

**Data model**
----------

An [Indicator](https://docs.google.com/document/d/1nipwFIaFwkHo4Gzw-qxZQpCjP_5tX7rbI3Ic5C56Z88/edit#heading=h.muftrcpnf89v) STIX Domain Object (SDO) is used to model patterns of expression such as the Poison Ivy file hash in this example. This hash is represented using the <span class="sdo">**pattern**</span> property of the Indicator object which is based on the [STIX patterning](https://docs.google.com/document/d/1suvd7z7YjNKWOwgko-vJ84jfGuxSYZjOQlw5leCswPY/edit#heading=h.jphmvccraytb) language. With this language, a comparison expression of the SHA-256 hash looks like: <span class="values">\[file:hashes.SHA-256= 'ef537f25c895bfa782526529a9b63d97aa631564d5d789c2b765448c8635fb6c'\]</span>. If known, other file attributes such as names or paths can be represented. Also, while this example covers just a file hash, many other [Cyber Observable Objects](https://docs.google.com/document/d/1DdS-NrVTjGJ3wvCJ7dbSlhYeiaWS6G6dOXu2F3POpUs/edit) and their properties can be modeled using Indicator patterns. For instance, email messages, domains, IP addresses, and processes are just a few examples.

Indicator objects also require a <span class="sdo">**labels**</span> property which helps to define what type of indicator is being represented. In this scenario, the hash value is associated with Poison Ivy, a known nefarious type of malware, so this indicator is labeled as <span class="values">malicious-activity</span>. This value is taken from the [Indicator Label](https://docs.google.com/document/d/1HRVFn2kAxBOTMbEb3KRu8tjMoHm-KRAI-2R8CTzGil4/edit#heading=h.cvhfwe3t9vuo) open vocabulary which provides other useful labels for classifying indicators.

Next, the details of the Poison Ivy malware are captured using a STIX [Malware](https://docs.google.com/document/d/1nipwFIaFwkHo4Gzw-qxZQpCjP_5tX7rbI3Ic5C56Z88/edit#heading=h.s5l7katgbp09) object. Malware objects in STIX also contain a required <span class="sdo">**labels**</span> property that is needed to specify the type of malware. In this case, Poison Ivy is a <span class="values">remote-access-trojan</span>. This value comes from the [Malware Label](https://docs.google.com/document/d/1HRVFn2kAxBOTMbEb3KRu8tjMoHm-KRAI-2R8CTzGil4/edit#heading=h.8cyb6e9yqzwr) open vocabulary, which contains several common types of malware categories such as virus, backdoor, spyware, etc.

These SDO’s are then coupled together via a [Relationship](https://docs.google.com/document/d/1nipwFIaFwkHo4Gzw-qxZQpCjP_5tX7rbI3Ic5C56Z88/edit#heading=h.e2e1szrqfoan) STIX Relationship Object (SRO). This Relationship connects the <span class="sdo">**source\_ref**</span>, Indicator, with the <span class="sdo">**target\_ref**</span>, Malware, via an <span class="values">indicates</span> <span class="sdo">**relationship\_type**</span>.

A diagram of this relationship below shows the Indicator and Malware SDO’s and the Relationship SRO between them:

![Malware indicator for file hash]({{ site.baseurl }}/img/Malware-Indicator-for-File-Hash.PNG)

**Further Reading**
---------------

To read more about the objects in this example as well as common properties and STIX patterning, check out the links below:

-   [Common Properties](https://docs.google.com/document/d/1HRVFn2kAxBOTMbEb3KRu8tjMoHm-KRAI-2R8CTzGil4/edit#heading=h.xzbicbtscatx)
-   [Vocabularies](https://docs.google.com/document/d/1HRVFn2kAxBOTMbEb3KRu8tjMoHm-KRAI-2R8CTzGil4/edit#heading=h.iit7tolczlxv)
-   [Malware](https://docs.google.com/document/d/1nipwFIaFwkHo4Gzw-qxZQpCjP_5tX7rbI3Ic5C56Z88/edit#heading=h.s5l7katgbp09)
-   [Indicator](https://docs.google.com/document/d/1nipwFIaFwkHo4Gzw-qxZQpCjP_5tX7rbI3Ic5C56Z88/edit#heading=h.muftrcpnf89v)
-   [Relationship](https://docs.google.com/document/d/1nipwFIaFwkHo4Gzw-qxZQpCjP_5tX7rbI3Ic5C56Z88/edit#heading=h.e2e1szrqfoan)
-   [STIX Patterning](https://docs.google.com/document/d/1suvd7z7YjNKWOwgko-vJ84jfGuxSYZjOQlw5leCswPY/edit#heading=h.jphmvccraytb)

**JSON**
------------------

```
{
  "type": "bundle",
  "id": "bundle--44af6c39-c09b-49c5-9de2-394224b04982",
  "spec_version": "2.0",
  "objects": [
    {
      "type": "indicator",
      "id": "indicator--a932fcc6-e032-176c-126f-cb970a5a1ade",
      "created": "2014-02-20T09:16:08.989000Z",
      "modified": "2014-02-20T09:16:08.989000Z",
      "name": "File hash for Poison Ivy variant",
      "description": "This file hash indicates that a sample of Poison Ivy is present.",
      "labels": [
        "malicious-activity"
      ],
      "pattern": "[file:hashes.SHA-256 = 'ef537f25c895bfa782526529a9b63d97aa631564d5d789c2b765448c8635fb6c']",
      "valid_from": "2014-02-20T09:00:00.000000Z"
    },
    {
      "type": "malware",
      "id": "malware--fdd60b30-b67c-11e3-b0b9-f01faf20d111",
      "created": "2014-02-20T09:16:08.989000Z",
      "modified": "2014-02-20T09:16:08.989000Z",
      "name": "Poison Ivy",
      "labels": [
        "remote-access-trojan"
      ]
    },
    {
      "type": "relationship",
      "id": "relationship--f191e70e-1736-47c3-b0f9-fdfe01387eb1",
      "created": "2014-02-20T09:16:08.989000Z",
      "modified": "2014-02-20T09:16:08.989000Z",
      "relationship_type": "indicates",
      "source_ref": "indicator--a932fcc6-e032-176c-126f-cb970a5a1ade",
      "target_ref": "malware--fdd60b30-b67c-11e3-b0b9-f01faf20d111"
    }
  ]
}
```
