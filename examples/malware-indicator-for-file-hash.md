---
layout: page
title: Malware Indicator for File Hash
categories: examples
---

A commonly-shared form of threat intelligence as practiced today is the sharing of host-based indicators for malicious code, which are most often file names and hashes. This example describes a file hash indicator and the name and type of the piece of malware that it indicates.

**Scenario**
----------

This scenario consists of the description of a simple indicator that represents a pattern for a file with a given hash and the context that if a file with that hash is seen it might indicate a sample of Poison Ivy is present.

**Data model**
----------

An [Indicator](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_muftrcpnf89v) STIX Domain Object (SDO) is used to model patterns of expression such as the Poison Ivy file hash in this example. This hash is represented using the <span class="sdo">**pattern**</span> property of the Indicator object which is based on the [STIX patterning](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_e8slinrhxcc9) language. With this language, a comparison expression of the SHA-256 hash looks like: <span class="values">\[file:hashes.'SHA-256'= 'ef537f25c895bfa782526529a9b63d97aa631564d5d789c2b765448c8635fb6c'\]</span>. If known, other file attributes such as names or paths can be represented. Also, while this example covers just a file hash, many other [Cyber Observable Objects](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_mlbmudhl16lr) and their properties can be modeled using Indicator patterns. For instance, email messages, domains, IP addresses, and processes are just a few examples.

Indicator objects also require a <span class="sdo">**indicator_types**</span> property which helps to define what type of indicator is being represented. In this scenario, the hash value is associated with Poison Ivy, a known nefarious type of malware, so this indicator is labeled as <span class="values">malicious-activity</span>. This value is taken from the [Indicator Type](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_cvhfwe3t9vuo) open vocabulary which provides other useful types for classifying indicators.

Next, the details of the Poison Ivy malware are captured using a STIX [Malware](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_s5l7katgbp09) object. Malware objects in STIX also contain a required <span class="sdo">**malware_types**</span> property that is needed to specify the type of malware. In this case, Poison Ivy is a <span class="values">remote-access-trojan</span>. This value comes from the [Malware Type](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_oxlc4df65spl) open vocabulary, which contains several common types of malware categories such as virus, backdoor, spyware, etc.

These SDO’s are then coupled together via a [Relationship](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_e2e1szrqfoan) STIX Relationship Object (SRO). This Relationship connects the <span class="sdo">**source\_ref**</span>, Indicator, with the <span class="sdo">**target\_ref**</span>, Malware, via an <span class="values">indicates</span> <span class="sdo">**relationship\_type**</span>.

A diagram of this relationship below shows the Indicator and Malware SDO’s and the Relationship SRO between them
[(An interactive version can be found here)](https://oasis-open.github.io/cti-stix-visualization/?url=https://raw.githubusercontent.com/oasis-open/cti-documentation/master/examples/example_json/malware-indicator-for-file-hash.json){: target="_blank"}:

![Malware indicator for file hash]({{ site.baseurl }}/img/Malware-Indicator-for-File-Hash.PNG)

**Further Reading**
---------------

To read more about the objects in this example as well as common properties and STIX patterning, check out the links below:

-   [Common Properties](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_xzbicbtscatx)
-   [Vocabularies](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_izngjy1g98l2)
-   [Malware](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_s5l7katgbp09)
-   [Indicator](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_muftrcpnf89v)
-   [Relationship](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_e2e1szrqfoan)
-   [STIX Patterning](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_e8slinrhxcc9)
-   [Cyber Observable Objects](https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_mlbmudhl16lr)

**Implementation**
------------------

{% include start_tabs.html tabs="JSON|Python Producer|Python Consumer" name="malware-hash" %}{% highlight json linenos %}
{% include_relative example_json/malware-indicator-for-file-hash.json %}
{% endhighlight %}{% include tab_separator.html %}{% highlight python linenos %}
{% include_relative producer_python/malware-indicator-for-file-hash-producer.py %}
{% endhighlight %}{% include tab_separator.html %}{% highlight python linenos %}
{% include_relative consumer_python/malware-indicator-for-file-hash-consumer.py %}
{% endhighlight %}{% include tab_separator.html %}{% highlight python linenos %}
{% endhighlight %}{% include end_tabs.html %}
